(function(e){function t(t){for(var r,o,s=t[0],c=t[1],u=t[2],d=0,h=[];d<s.length;d++)o=s[d],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&h.push(a[o][0]),a[o]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);l&&l(t);while(h.length)h.shift()();return i.push.apply(i,u||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],r=!0,s=1;s<n.length;s++){var c=n[s];0!==a[c]&&(r=!1)}r&&(i.splice(t--,1),e=o(o.s=n[0]))}return e}var r={},a={app:0},i=[];function o(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=r,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/localizer/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var u=0;u<s.length;u++)t(s[u]);var l=c;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},1:function(e,t){},2:function(e,t){},3:function(e,t){},4:function(e,t){},5:function(e,t){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("2b0e"),a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("keep-alive",[n("router-view")],1)],1)},i=[],o=n("2877"),s={},c=Object(o["a"])(s,a,i,!1,null,null,null),u=c.exports,l=n("8c4f"),d=n("5f5b"),h=n("b1e0"),f=n("b1fc"),p=n("bd8c"),g=n.n(p),b=n("ecee"),v=n("ad3d"),m=n("f2d1"),w=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"home"},[n("Main",{attrs:{msg:"Object Localization With Orientation"}})],1)},y=[],x=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-container",[e.state===e.stateKind.WELCOME?[n("h1",[e._v("Hand Detector")]),n("h4",[e._v("Localizer demo app")]),n("div",{staticClass:"social-share"},[n("ShareNetwork",{attrs:{network:"Facebook",url:e.shareUrl(),title:e.shareTitle()}},[n("b-button",{attrs:{variant:"secondary"}},[n("font-awesome-icon",{attrs:{icon:["fab","facebook"],size:"lg"}})],1)],1),n("ShareNetwork",{attrs:{network:"Twitter",url:e.shareUrl(),title:e.shareTitle()}},[n("b-button",{attrs:{variant:"secondary"}},[n("font-awesome-icon",{attrs:{icon:["fab","twitter"],size:"lg"}})],1)],1),n("ShareNetwork",{attrs:{network:"VK",url:e.shareUrl(),title:e.shareTitle()}},[n("b-button",{attrs:{variant:"secondary"}},[n("font-awesome-icon",{attrs:{icon:["fab","vk"],size:"lg"}})],1)],1),n("ShareNetwork",{attrs:{network:"Email",url:e.shareUrl(),title:e.shareTitle(),description:"Check out the localizer demo app."}},[n("b-button",{attrs:{variant:"secondary"}},[n("b-icon",{attrs:{icon:"envelope"}})],1)],1)],1),n("div",{staticClass:"youtube-super-container"},[n("div",{staticClass:"youtube-container"},[n("iframe",{staticClass:"youtube-video",attrs:{src:"https://www.youtube.com/embed/M1_5VaDYxK4",frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:""}})])]),n("div",{staticClass:"main-text"},[n("p",[e._v("This app detects your hands on a live camera video. It is powered by the "),n("b",[e._v("Localizer")]),e._v(": a deep neural network for object detection.")]),n("p",[e._v("Popular algorithms like YOLO find axis-aligned or rotated bounding boxes, which is only a rough description of the object's location. In contrast, Localizer predicts accurate object coordinates and orientation. This data is essential, for example, in robotic applications, to plan precise motions and avoid collisions.")]),n("p",[n("a",{attrs:{href:"https://github.com/ivan-alles/localizer"}},[e._v("Get more")]),e._v(" on GitHub: source code, examples, hands-on python app.")])]),n("b-button",{attrs:{variant:"primary"},on:{click:function(t){return e.startDemo()}}},[n("b-icon",{attrs:{icon:"camera-video"}}),e._v(" Start ")],1)]:e._e(),e.state===e.stateKind.INIT?[n("h4",[n("b-spinner",{attrs:{variant:"secondary",label:"Loading"}}),e._v(" "+e._s(e.progressMessage)+" ")],1),e.isMobile?[n("p",[e._v("Running this app on a mobile device can be slow or irresponsive. It works best on a desktop with an NVIDIA graphic card.")])]:e._e()]:e._e(),e.state===e.stateKind.WORKING?[n("div",{attrs:{id:"viewContainer"}},[n("canvas",{attrs:{id:"viewCanvas"}}),e.isVideoShown?n("b-button",{attrs:{variant:"secondary",id:"stopDemoButton"},on:{click:function(t){return e.stopDemo()}}},[n("b-icon",{attrs:{icon:"stop-fill"}}),e._v(" Quit ")],1):e._e()],1)]:e._e(),e.state===e.stateKind.ERROR?[n("h4",{staticClass:"error"},[n("b-icon",{attrs:{icon:"exclamation-circle-fill",variant:"danger"}}),e._v(" Error ")],1),n("p",[e._v(" This app works best on a desktop with an NVIDIA graphic card. Other devices may not be supported. ")]),n("b-button",{attrs:{variant:"primary"},on:{click:function(t){return e.reload()}}},[n("b-icon",{attrs:{icon:"bootstrap-reboot"}}),e._v(" Reload ")],1),n("b-button",{attrs:{variant:"secondary"},on:{click:function(t){e.showFatalError=!0}}},[e._v(" Details ")]),e.showFatalError?[n("p",{staticClass:"fatal-error-text"},[e._v(e._s(this.fatalError))])]:e._e()]:e._e()],2)},k=[],O=(n("b0c0"),n("d3b7"),n("b85c")),E=(n("96cf"),n("1da1")),R=n("d4ec"),_=n("bee2"),I=n("ce1a"),T=n("0ad6"),j="/prediction_model.tfjs/model.json",M=88;function D(e,t){return e%t==0?0:t-e%t}function V(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:511,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:32,r=e.shape[1],a=e.shape[0],i=t/r,o=t/a,s=0;(i<1||o<1)&&(i<o?(s=i,r=t,a=Math.floor(a*s)):(s=o,r=Math.floor(r*s),a=t),e=I["h"].resizeBilinear(e,[a,r]));var c=D(r,n),u=D(a,n);return 0==c&&0==u||(e=I["i"](e,[[0,u],[0,c],[0,0]])),e=I["g"](I["k"](e,2),0),{image:e,scale:s}}var C=function(){function e(t){Object(R["a"])(this,e),this.logger=t}return Object(_["a"])(e,[{key:"init",value:function(){var e=Object(E["a"])(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.maxInputSize=t,r=j,r="/localizer"+r,console.log("Loading model ".concat(r," ...")),e.next=6,Object(T["a"])(r,{onProgress:function(e){var t=Math.round(100*e);n("Loading neural network: ".concat(t,"%"))}});case 6:this.model=e.sent,console.log("Model loaded");case 8:case"end":return e.stop()}}),e,this)})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"predict",value:function(){var e=Object(E["a"])(regeneratorRuntime.mark((function e(t){var n,r,a,i,o,s=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=null,r=null,e.prev=2,n=I["l"]((function(){return V(t,s.maxInputSize,32)})),e.next=6,this.model.executeAsync({image:n.image});case 6:return r=e.sent,e.next=9,r.data();case 9:for(a=e.sent,i=[],o=0;o<a.length;o+=5)i.push({x:8*a[o]/n.scale,y:8*a[o+1]/n.scale,angle:a[o+2]});return e.abrupt("return",{objects:i,objectSize:M/n.scale});case 15:e.prev=15,e.t0=e["catch"](2),this.logger.logException("Localizer.predict",e.t0);case 18:return e.prev=18,null!==n&&I["d"](n.image),I["d"](r),e.finish(18);case 22:return e.abrupt("return",null);case 23:case"end":return e.stop()}}),e,this,[[2,15,18,22]])})));function t(t){return e.apply(this,arguments)}return t}()}]),e}(),A=function(){function e(t){Object(R["a"])(this,e),this.logger=t,this.initDone=!1}return Object(_["a"])(e,[{key:"init",value:function(){var e=Object(E["a"])(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.initDone){e.next=3;break}return console.log("Init already done"),e.abrupt("return");case 3:return e.next=5,I["j"]();case 5:return console.log("Initial tf.ENV.features",I["a"].features),I["a"].set("WEBGL_CONV_IM2COL",!1),I["a"].set("WEBGL_FORCE_F16_TEXTURES",!0),I["a"].set("WEBGL_RENDER_FLOAT32_ENABLED",!1),e.next=11,I["j"]();case 11:return console.log("New tf.ENV.features",I["a"].features),console.log("Production mode"),I["f"](),this.localizer=new C(this.logger),e.next=16,this.localizer.init(t,n);case 16:this.initDone=!0;case 17:case"end":return e.stop()}}),e,this)})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"predict",value:function(){var e=Object(E["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=null,e.prev=1,n=I["l"]((function(){return I["e"](I["c"](I["b"].fromPixels(t),"float32"),255)})),e.next=5,this.localizer.predict(n);case 5:return e.abrupt("return",e.sent);case 6:return e.prev=6,I["d"](n),e.finish(6);case 9:case"end":return e.stop()}}),e,this,[[1,,6,9]])})));function t(t){return e.apply(this,arguments)}return t}()}]),e}(),L=5e3,N=2e3,S={WELCOME:"WELCOME",INIT:"INIT",WORKING:"WORKING",EXIT:"EXIT",ERROR:"ERROR"},z=function(){function e(t){Object(R["a"])(this,e),this.gtag=t}return Object(_["a"])(e,[{key:"log",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;console.log(e,t,n,r),this.gtag.event({eventCategory:e,eventAction:t,eventLabel:n,eventValue:r})}},{key:"logException",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;console.error(e,t,n),this.gtag.event({eventCategory:"LogError",eventAction:e,eventLabel:t.stack,eventValue:n})}}]),e}(),P={data:function(){return{state:S.WELCOME,isMobile:!1,progressMessage:"Loading ...",tempResultPicture:null,camera:null,isVideoReady:!1,isVideoShown:!1,isDetecting:!1,isHandIconOn:!1,handIconTime:new Date-L,fatalError:"",showFatalError:!1}},computed:{},methods:{detectionTask:function(){var e=this;return Object(E["a"])(regeneratorRuntime.mark((function t(){var n,r,a,i,o,s,c,u,l,d,h,f,p,g,b,v,m,w,y,x,k,E,R,_;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.isDetecting=!1,e.isVideoShown=!1,n=e.isMobile?256:512,t.next=6,e.engine.init(n,(function(t){e.progressMessage=t}));case 6:e.progressMessage="Warming up ...",r=new Image,a=!1,r.onload=function(){a=!0},r.src="hand.svg";case 11:if(a){t.next=16;break}return t.next=14,W(50);case 14:t.next=11;break;case 16:if(e.isVideoReady||e.state==S.ERROR){t.next=21;break}return t.next=19,W(50);case 19:t.next=16;break;case 21:if(console.log("isVideoReady state: ",e.isVideoReady),e.state!=S.ERROR){t.next=24;break}return t.abrupt("return");case 24:e.state=S.WORKING;case 25:return e.isDetecting=!1,t.next=28,W(50);case 28:if(e.isActive){t.next=30;break}return t.abrupt("continue",63);case 30:if(e.state==S.WORKING){t.next=32;break}return t.abrupt("break",65);case 32:return e.isDetecting=!0,i=document.createElement("canvas"),i.setAttribute("width",e.camera.videoWidth),i.setAttribute("height",e.camera.videoHeight),o=i.getContext("2d"),o.translate(i.width,0),o.scale(-1,1),o.drawImage(e.camera,0,0),o.resetTransform(),t.next=43,e.engine.predict(i);case 43:s=t.sent,c=s.objects,u=s.objectSize,l=document.getElementById("viewCanvas"),d=document.getElementById("viewContainer"),h=d.getBoundingClientRect(),f=h.width,p=window.innerHeight-h.y-2,g=f/i.width,b=p/i.height,v=1,g<b?(l.setAttribute("width",f),l.setAttribute("height",i.height*g),v=g):(l.setAttribute("height",p),l.setAttribute("width",i.width*b),v=b),m=l.getContext("2d"),m.drawImage(i,0,0,l.width,l.height),w=v*u/2,y=new Date,e.isHandIconOn?y-e.handIconTime>N||c.length>0?(e.handIconTime=y,e.isHandIconOn=!1):(m.drawImage(r,l.width/2-w,l.height/2-w,2*w,2*w),m.font="24px arial",m.fillStyle="#0AAF0A",m.textAlign="center",m.textBaseline="top",m.fillText("show me your hand",l.width/2,l.height/2+w)):y-e.handIconTime>L&&(e.handIconTime=y,e.isHandIconOn=!0),x=Object(O["a"])(c);try{for(x.s();!(k=x.n()).done;)E=k.value,R=Math.sin(E.angle)*w,_=Math.cos(E.angle)*w,m.setTransform(_,R,-R,_,E.x*v,E.y*v),m.beginPath(),m.moveTo(0,0),m.lineTo(1,0),m.moveTo(1,0),m.lineTo(.8,-.15),m.moveTo(1,0),m.lineTo(.8,.15),m.arc(0,0,1,0,2*Math.PI),m.resetTransform(),m.lineWidth=3,m.strokeStyle="#0AAF0A",m.stroke()}catch(I){x.e(I)}finally{x.f()}e.isVideoShown=!0;case 63:t.next=25;break;case 65:t.next=72;break;case 67:t.prev=67,t.t0=t["catch"](0),e.logger.logException("Main.detectionTask.createPictures",t.t0),e.fatalError=t.t0.stack,e.state!=S.WELCOME&&(e.state=S.ERROR);case 72:e.isDetecting=!1;case 73:case"end":return t.stop()}}),t,null,[[0,67]])})))()},reload:function(){location.reload()},startDemo:function(){this.state=S.INIT,this.startVideo(),this.detectionTask()},stopDemo:function(){var e=this;return Object(E["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.state!=S.WORKING||!e.isDetecting){t.next=5;break}return t.next=3,W(50);case 3:t.next=0;break;case 5:e.state=S.WELCOME;case 6:case"end":return t.stop()}}),t)})))()},onVideoReady:function(){console.log("Video ready."),this.isVideoReady=!0},onVideoError:function(){this.logger.logException("Images.onVideoError",this.camera.error.message),this.isVideoReady=!1,this.fatalError=this.camera.error.message,this.state=S.ERROR},startVideo:function(){var e=this;return Object(E["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,null===e.camera){t.next=3;break}return t.abrupt("return");case 3:if(e.camera=document.createElement("video"),!navigator.mediaDevices.getUserMedia){t.next=8;break}return t.next=7,navigator.mediaDevices.getUserMedia({video:!0});case 7:e.camera.srcObject=t.sent;case 8:e.camera.onloadeddata=e.onVideoReady,e.camera.play(),t.next=17;break;case 12:t.prev=12,t.t0=t["catch"](0),e.logger.logException("Images.startVideo",t.t0),e.fatalError=t.t0.stack,e.state=S.ERROR;case 17:case"end":return t.stop()}}),t,null,[[0,12]])})))()},shareUrl:function(){return window.location.href},shareTitle:function(){return"Hand Detector"}},created:function(){this.stateKind=S,this.isMobile=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),this.$gtag.event("test_event",{method:"Google"}),this.logger=new z(this.$gtag),this.logger.log("test category","test action","test label",123),this.isActive=!0,this.engine=new A(this.logger)},mounted:function(){},beforeDestroy:function(){this.state=S.EXIT},updated:function(){},watch:{$route:function(e,t){this.isActive="Home"===e.name}}};function W(e){return new Promise((function(t){return setTimeout(t,e)}))}var B=P,G=(n("dba9"),Object(o["a"])(B,x,k,!1,null,"bc46e4f2",null)),K=G.exports,H={name:"Home",components:{Main:K}},F=H,U=Object(o["a"])(F,w,y,!1,null,null,null),$=U.exports;n("f669");b["c"].add(m["c"]),b["c"].add(m["a"]),b["c"].add(m["b"]),r["default"].component("font-awesome-icon",v["a"]),r["default"].use(d["a"]),r["default"].use(h["a"]),r["default"].use(f["a"]),r["default"].use(l["a"]),r["default"].use(g.a);var X=[{path:"/",name:"Home",component:$}],J=new l["a"]({mode:"history",base:"/localizer/",routes:X}),Q=J,Y=n("a584");r["default"].config.productionTip=!1,r["default"].use(Y["a"],{config:{id:"G-VMZBN6EQSD"}}),new r["default"]({router:Q,render:function(e){return e(u)}}).$mount("#app")},d255:function(e,t,n){},dba9:function(e,t,n){"use strict";n("d255")},f669:function(e,t,n){}});
//# sourceMappingURL=app.b738b53c.js.map